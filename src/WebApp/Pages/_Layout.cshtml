@using Microsoft.AspNetCore.Components.Web
@namespace WebApp.Pages
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@inject Microsoft.AspNetCore.Antiforgery.IAntiforgery Antiforgery

<!DOCTYPE html>
<html lang="tr" dir="ltr">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <base href="~/" />
    
    <!-- Language and Direction Support -->
    <meta name="language" content="tr" />
    <meta name="dir" content="ltr" />
    
    <!-- PWA Meta Tags -->
    <meta name="application-name" content="Getir" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Getir" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="msapplication-config" content="/browserconfig.xml" />
    <meta name="msapplication-TileColor" content="#5d3ebc" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="theme-color" content="#5d3ebc" />
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Getir ile market, eczane ve restoran ürünlerini dakikalar içinde kapınıza getiriyoruz. Hızlı, güvenli ve kolay alışveriş deneyimi." />
    <meta name="keywords" content="getir, hızlı teslimat, market, eczane, restoran, online alışveriş, kapıda ödeme, güvenli ödeme" />
    <meta name="author" content="Getir" />
    <meta name="robots" content="index, follow" />
    
    <!-- CSRF Token Meta -->
    @{ var tokens = Antiforgery.GetAndStoreTokens(Context); }
    <meta name="csrf-token" content="@tokens.RequestToken" />
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Getir - Hızlı Teslimat" />
    <meta property="og:description" content="Market, eczane ve restoran ürünlerini dakikalar içinde kapınıza getiriyoruz." />
    <meta property="og:image" content="https://ajilgo.runasp.net/images/getir-og-image.jpg" />
    <meta property="og:url" content="https://ajilgo.runasp.net" />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="Getir" />
    <meta property="og:locale" content="tr_TR" />
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Getir - Hızlı Teslimat" />
    <meta name="twitter:description" content="Market, eczane ve restoran ürünlerini dakikalar içinde kapınıza getiriyoruz." />
    <meta name="twitter:image" content="https://ajilgo.runasp.net/images/getir-og-image.jpg" />
    <meta name="twitter:site" content="@@getir" />
    <meta name="twitter:creator" content="@@getir" />
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json" />
    
    <!-- Favicon and Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5d3ebc" />
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/bootstrap/bootstrap.min.css" />
    <link href="css/site.css" rel="stylesheet" />
    <link href="WebApp.styles.css" rel="stylesheet" />
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    
    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- RTL Support CSS -->
    <style>
        [dir="rtl"] {
            text-align: right;
        }
        
        [dir="rtl"] .navbar-nav {
            flex-direction: row-reverse;
        }
        
        [dir="rtl"] .dropdown-menu {
            right: 0;
            left: auto;
        }
        
        [dir="rtl"] .form-control {
            text-align: right;
        }
        
        [dir="rtl"] .btn-group > .btn:not(:last-child):not(.dropdown-toggle) {
            border-top-left-radius: 0;
            border-bottom-left-radius: 0;
            border-top-right-radius: 0.375rem;
            border-bottom-right-radius: 0.375rem;
        }
        
        [dir="rtl"] .btn-group > .btn:not(:first-child) {
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
            border-top-left-radius: 0.375rem;
            border-bottom-left-radius: 0.375rem;
        }
        
        [dir="rtl"] .card {
            text-align: right;
        }
        
        [dir="rtl"] .list-group-item {
            text-align: right;
        }
        
        [dir="rtl"] .modal-header .btn-close {
            margin: -0.5rem auto -0.5rem -0.5rem;
        }
        
        [dir="rtl"] .offcanvas-header .btn-close {
            margin: -0.5rem -0.5rem -0.5rem auto;
        }
        
        /* Arabic font support */
        [lang="ar"] {
            font-family: 'Segoe UI', 'Tahoma', 'Arial', sans-serif;
        }
        
        [lang="ar"] .arabic-text {
            font-family: 'Segoe UI', 'Tahoma', 'Arial', sans-serif;
            direction: rtl;
            text-align: right;
        }
    </style>
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@@context": "https://schema.org",
      "@@type": "Organization",
      "name": "Getir",
      "url": "https://ajilgo.runasp.net",
      "logo": "https://ajilgo.runasp.net/images/getir-logo.png",
      "description": "Hızlı teslimat ile market, eczane ve restoran ürünlerini kapınıza getiriyoruz.",
      "contactPoint": {
        "telephone": "+90-212-123-45-67",
        "contactType": "customer service",
        "availableLanguage": ["Turkish", "English"]
      },
      "sameAs": [
        "https://www.facebook.com/getir",
        "https://www.twitter.com/getir",
        "https://www.instagram.com/getir"
      ]
    }
    </script>
    
    <component type="typeof(HeadOutlet)" render-mode="ServerPrerendered" />
</head>
<body>
    @RenderBody()

    <div id="blazor-error-ui">
        <environment include="Staging,Production">
            An error has occurred. This application may no longer respond until reloaded.
        </environment>
        <environment include="Development">
            An unhandled exception has occurred. See browser dev tools for details.
        </environment>
        <a href="" class="reload">Reload</a>
        <a class="dismiss">🗙</a>
    </div>

    <script src="_framework/blazor.server.js"></script>
    <script src="js/site.js"></script>
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('Service Worker registered successfully:', registration.scope);
                    })
                    .catch(function(error) {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }
        
        // PWA Install Prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Show install buttons
            const installButton = document.getElementById('install-button');
            const installButtonMobile = document.getElementById('install-button-mobile');
            
            if (installButton) {
                installButton.style.display = 'inline-block';
                installButton.classList.remove('d-none');
            }
            if (installButtonMobile) {
                installButtonMobile.style.display = 'inline-block';
                installButtonMobile.classList.remove('d-none');
            }
        });
        
        window.addEventListener('appinstalled', () => {
            const installButton = document.getElementById('install-button');
            const installButtonMobile = document.getElementById('install-button-mobile');
            
            if (installButton) installButton.style.display = 'none';
            if (installButtonMobile) installButtonMobile.style.display = 'none';
        });
    </script>
</body>
</html>
