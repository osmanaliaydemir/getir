@inject ILocalizationService LocalizationService
@model List<Getir.MerchantPortal.Models.CategoryTreeNode>
@{
    ViewData["Title"] = LocalizationService.GetString("Categories");
    var allCategories = ViewBag.AllCategories as List<Getir.MerchantPortal.Models.ProductCategoryResponse> ?? new();
}

@section Styles {
    <link rel="stylesheet" href="~/css/dashboard-modern.css" />
    <link rel="stylesheet" href="~/css/modules/categories/categories.css" asp-append-version="true" />
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h3><i class="fas fa-tags"></i> @LocalizationService.GetString("Categories")</h3>
        <p class="text-muted mb-0" id="reorderHint" style="display: none;">
            <i class="fas fa-arrows-alt-v me-2"></i>@LocalizationService.GetString("Categories")
        </p>
    </div>
    <div class="d-flex gap-2">
        <button type="button" class="btn btn-outline-primary" id="toggleReorderBtn">
            <i class="fas fa-arrows-alt-v"></i> @LocalizationService.GetString("Filter")
        </button>
        <button type="button" class="btn btn-success" id="saveOrderBtn" style="display: none;">
            <i class="fas fa-save"></i> @LocalizationService.GetString("Save")
        </button>
        <button type="button" class="btn btn-secondary" id="cancelOrderBtn" style="display: none;">
            <i class="fas fa-times"></i> @LocalizationService.GetString("Cancel")
        </button>
        <a href="@Url.Action("Create")" class="btn btn-getir">
            <i class="fas fa-plus"></i> @LocalizationService.GetString("AddCategory")
        </a>
    </div>
</div>

<div class="row">
    <div class="col-md-8">
        <div class="stat-card">
            <h5 class="mb-3">
                <i class="fas fa-sitemap"></i> @LocalizationService.GetString("CategoryList")
            </h5>
            
            @if (Model != null && Model.Any())
            {
                <div class="category-tree">
                    @foreach (var node in Model)
                    {
                        @await Html.PartialAsync("_CategoryTreeNode", node)
                    }
                </div>
            }
            else
            {
                <div class="text-center py-5">
                    <i class="fas fa-tags fa-3x text-muted mb-3"></i>
                    <p class="text-muted">@LocalizationService.GetString("NoData")</p>
                    <a href="@Url.Action("Create")" class="btn btn-getir">
                        <i class="fas fa-plus me-2"></i>@LocalizationService.GetString("AddCategory")
                    </a>
                </div>
            }
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="stat-card">
            <h5 class="mb-3">
                <i class="fas fa-chart-bar"></i> @LocalizationService.GetString("Stats")
            </h5>
            <div class="stat-item">
                <span class="stat-label">@LocalizationService.GetString("Total"):</span>
                <span class="stat-value">@allCategories.Count</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">@LocalizationService.GetString("Active"):</span>
                <span class="stat-value text-success">@allCategories.Count(c => c.IsActive)</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">@LocalizationService.GetString("Inactive"):</span>
                <span class="stat-value text-muted">@allCategories.Count(c => !c.IsActive)</span>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/modules/categories/categories.js" asp-append-version="true"></script>
}
